<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        margin: 0;
        font-family: Inter, Arial, sans-serif;
        background: linear-gradient(180deg, #e6effc, #f7f9fc);
    }

    /* Sidebar */
    .sidebar {
        width: 230px;
        height: 100vh;
        background: #18324b;
        color: white;
        position: fixed;
        left: 0;
        top: 0;
        padding: 20px;
    }

    .sidebar .logo {
        font-weight: 900;
        font-size: 24px;
        background: #0b84ff;
        padding: 12px 15px;
        border-radius: 10px;
        display: inline-block;
        margin-bottom: 30px;
    }

    .sidebar a {
        display: block;
        color: #dbe7ff;
        padding: 12px 10px;
        margin: 4px 0;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 500;
    }

    .sidebar a.active,
    .sidebar a:hover {
        background: #0b84ff;
        color: white;
    }

    .logout {
        position: absolute;
        bottom: 20px;
        left: 20px;
        color: #f8d7da;
        font-weight: 600;
        cursor: pointer;
    }

    /* Content area */
    .content {
        margin-left: 260px;
        padding: 30px;
    }

    h1 {
        font-size: 34px;
        color: #12263f;
        margin-bottom: 4px;
    }

    .subtitle {
        color: #63758b;
        margin-bottom: 25px;
    }

    /* Stats cards */
    .stats {
        display: flex;
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-box {
        flex: 1;
        background: white;
        padding: 18px;
        border-radius: 12px;
        box-shadow: 0 4px 18px rgba(0,0,0,0.05);
        font-weight: 600;
        color: #344767;
    }

    .stat-number {
        font-size: 32px;
        margin-top: 6px;
        color: #0b84ff;
    }

    /* Sections */
    .section {
        background: white;
        padding: 20px;
        margin-top: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 18px rgba(0,0,0,0.05);
    }

    .section h3 {
        margin: 0 0 12px;
        color: #12263f;
    }

    .report-item {
        padding: 12px;
        border: 1px solid #e6e6e6;
        border-radius: 8px;
        margin-bottom: 12px;
    }

    .btn-view {
        background: #0b84ff;
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        text-decoration: none;
        font-size: 14px;
    }

    ul.tips li {
        margin-bottom: 8px;
    }
</style>

</head>

<body>

<!-- Sidebar -->
<div class="sidebar">
    <div class="logo">C</div>

    <a class="active">Dashboard</a>
    <a href="/report/new">Report Crime</a>
    <a href="#history">History</a>
    <a href="/account">Account</a>

    <div class="logout" onclick="location.href='/logout'">Logout</div>
</div>

<!-- Content -->
<div class="content">

    <h1>Welcome, {{ user.name }}.</h1>
    <div class="subtitle">Report incidents quickly and stay updated.</div>

    <!-- Stats -->
    <div class="stats">
        <div class="stat-box">
            Active Reports
            <div class="stat-number">{{ active_reports }}</div>
        </div>

        <div class="stat-box">
            Solved Reports
            <div class="stat-number">{{ pending_reports }}</div>
        </div>

        <div class="stat-box">
            Total Reports
            <div class="stat-number">{{ total_reports }}</div>
        </div>
    </div>

    <!-- Recent Reports -->
<!-- MY REPORTS -->
<div class="section" style="margin-top: 40px;">
    <h3 style="font-size: 22px; margin-bottom: 20px;">My Reports</h3>

    {% if my_reports %}
        {% for r in my_reports %}
        <div class="report-item" style="
            padding: 18px;
            border: 1px solid #d8e3f0;
            border-radius: 12px;
            margin-bottom: 15px;
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.04);
        ">
            <div style="display:flex; justify-content:space-between; align-items:center;">

                <!-- LEFT SECTION -->
                <div style="max-width: 70%;">
                    <strong style="font-size: 18px; color:#0b2e4a;">
                        {{ r.title | capitalize }}
                    </strong>

                    <p style="margin:4px 0; color:#4a6073;">
                        üìç {{ r.location_name or "Unknown location" }}
                    </p>

                    <p style="margin:4px 0; font-size: 13px; color:#6b7b8c;">
                        {{ r.created_at }}
                    </p>

                    <!-- STATUS BADGE -->
                    <span style="
                        background:#0b84ff; 
                        padding:3px 8px; 
                        border-radius:6px; 
                        color:white; 
                        font-size:12px;
                    ">
                        {{ r.status }}
                    </span>

                    <!-- PREDICTED TYPE BADGE -->
                    <span style="
                        background:#ff4757; 
                        padding:3px 8px; 
                        border-radius:6px; 
                        color:white; 
                        font-size:12px;
                        margin-left:6px;
                    ">
                        {{ r.predicted_type }}
                    </span>

                    <!-- SEVERITY BADGE -->
                    {% if r.severity %}
                    <span style="
                        background:#ffa502; 
                        padding:3px 8px; 
                        border-radius:6px; 
                        color:white; 
                        font-size:12px;
                        margin-left:6px;
                    ">
                        {{ r.severity }}
                    </span>
                    {% endif %}
                </div>

                <!-- VIEW BUTTON -->
                <a class="btn-view" href="/report/view/{{ r.id }}" style="
                    padding:8px 14px;
                    background:#0b84ff;
                    color:white;
                    border-radius:8px;
                    text-decoration:none;
                    font-weight:600;
                ">View</a>

            </div>
        </div>
        {% endfor %}

    {% else %}
        <p style="color:#6b7b8c;">You haven't reported any crimes yet.</p>
    {% endif %}
</div>

<!-- COMMUNITY REPORTS -->
<div class="section" style="margin-top: 40px;">
    <h3 style="font-size: 22px; margin-bottom: 20px;">Community Crime Reports</h3>

    {% if community_reports %}
        {% for r in community_reports %}
        <div class="report-item" style="
            padding: 18px;
            border: 1px solid #d8e3f0;
            border-radius: 12px;
            margin-bottom: 15px;
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.04);
        ">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                
                <!-- LEFT SIDE TEXT -->
                <div style="max-width: 70%;">
                    <strong style="font-size: 18px; color:#0b2e4a;">
                        {{ r.title | capitalize }}
                    </strong>

                    <p style="margin:4px 0; color:#4a6073;">
                        üìç {{ r.location_name or "Unknown location" }}
                    </p>

                    <p style="margin:4px 0; font-size: 13px; color:#6b7b8c;">
                        Reported By: <strong>{{ r.name }}</strong>
                        &nbsp; ‚Ä¢ &nbsp;
                        {{ r.created_at }}
                    </p>

                    <span style="
                        background:#0b84ff; 
                        padding:3px 8px; 
                        border-radius:6px; 
                        color:white; 
                        font-size:12px;
                    ">
                        {{ r.status }}
                    </span>

                    <span style="
                        background:#ff4757; 
                        padding:3px 8px; 
                        border-radius:6px; 
                        color:white; 
                        font-size:12px;
                        margin-left:6px;
                    ">
                        {{ r.predicted_type }}
                    </span>
                    
                    
                </div>

                <!-- VIEW BUTTON -->
                <a class="btn-view" href="/report/view/{{ r.id }}" style="
                    padding:8px 14px; 
                    background:#0b84ff; 
                    color:white; 
                    border-radius:8px;
                    text-decoration:none;
                    font-weight:600;
                ">View</a>

            </div>
        </div>
        {% endfor %}

    {% else %}
        <p style="color:#6b7b8c;">No community reports available.</p>
    {% endif %}
</div>

    <!-- Safety Tips -->
    <div class="section">
        <h3>Safety Tips</h3>
        <ul class="tips">
            <li>Be aware of your surroundings.</li>
            <li>Avoid dark or isolated areas late at night.</li>
            <li>Keep emergency contacts handy.</li>
            <li>Trust your instincts ‚Äî avoid unsafe situations.</li>
        </ul>
    </div>



<a href="/user/sos/history">SOS History</a>

</body>
</html>
